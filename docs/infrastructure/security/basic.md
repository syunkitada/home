# Basic

## 脆弱性

- 脆弱性とはソフトウェアやハードウェアに含まれるセキュリティ上の不備のこと
- Exploit
  - PC やスマートフォンの OS・ソフトウェアなどの脆弱性を悪用して攻撃を行うプログラムのこと
- バッファオーバーフロー
  - 特定のデータ構造の限界の外に書き込みを行ったとき、不適切な位置にデータを書き込み不正なコードを実行する
  - メモリ管理がプログラマに任される C のコードでよく発見される
- 脆弱性データベース
  - 基本的には脆弱性の発見には脆弱性データベースを利用して発見することになる
  - CVE(Common Vulnerabilities and Exposures)
    - 脆弱性やインシデントについて、それぞれ固有の名前や番号を付与してリスト化したもの
  - MITRE
    - 米国政府の支援を受けた非営利団体の名称
    - CERT/CC や、HP、IBM、OSVDB、Red Hat、Symantec などの脆弱性情報サイトと連携して、脆弱性情報の収集と、重複のない CVE の裁判に努めている
  - CVE 互換認定
    - 脆弱性検査ツールや脆弱性対策情報提供サービス等が、いくつかの機能要件を満たし、MITRE へ申請すると CVE 互換認定が受けられる
    - 日本では、以下が CVE 互換認定を受けている
      - [Japan Vulnerability Notes](http://jvn.jp/)
      - [JVN iPedia](https://jvndb.jvn.jp/index.html)
      - [MyJVN](https://jvndb.jvn.jp/apis/myjvn/)
- 脆弱性の発見方法
  - 脆弱性データベースは日々更新されるので、脆弱性はスキャンは単発ではなく、定期的にスキャンする必要がある
  - 脆弱性スキャンは、Github などのソースリポジトリや、Dockerhub のようなイメージリポジトリにたいして行われる
  - また、本番サーバ上のパッケージリストを定期収集しておいて、それをスキャンする手法もある
  - 基本的な検査ツールではパッケージベースで脆弱性を検知するものが多く、tar などを展開してインストールされるものは検知できないものが多い
- 参考
  - [コンテナ・セキュリティ入門 脆弱性](https://qiita.com/MahoTakara/items/47d9c4ecd67f82977ca8)

## 攻撃経路

- リモートからの攻撃
  - リモートユーザは最初にネットワークプログラムの脆弱性によって、そのプログラムの権限でコードを実行する
    - また、必要に応じてより高い権限へ昇格してコードを実行する
  - 対策
    - 外部からアクセス可能なポートを制限する
    - nginx や haproxy などのプロキシコンテナを前段においてネットワークプログラムを直接見せないようにする
      - 攻撃者は、プロキシコンテナの脆弱性を突いたうえで、さらに奥のネットワークプログラムの脆弱性を突かなければならくなるため難易度が上がる
    - ネットワークプログラムの権限を必要最低限に絞っておく
      - 成功したエクスプロイトによる影響を抑えることができる
      - また、root で起動して必要なパスワードなどの情報をメモリに保存した後、setuid を使って権限を降格する場合もある
- 従業員端末からの攻撃
  - 端末にメールなど何らかの方法でマルウェアを感染させて、そこから社内ネットワークに侵入して攻撃する
    - メールの添付ファイルやリンクは不用意に開いてはいけない
  - プライベートネットワークからの攻撃対策はおろそかになってる場合が多く注意が必要である
- 仮想マシン上からの攻撃
  - 仮想マシンは、ハイパーバイザ上で動作するため、ハイパーバイザプログラムや、CPU の脆弱性をつくことでハイパーバイザや、同居している仮想マシンへの攻撃が可能
- Supply Chain Attack
  - パッケージやイメージなどに含まれるライブラリなどに攻撃コードを仕込んで攻撃する手法
  - インターネット上のパッケージやイメージやライブラリを利用している場合は、このような危険性をはらんでいる
  - 対策が難しい

## 攻撃ツール

- 脆弱性の攻撃ツールや、bot net などは dark web や twitter で買うことができる
- zero-day attack のみではなく、既存の脆弱性も警戒すべき
